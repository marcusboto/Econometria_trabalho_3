"Regiao Centro-Oeste", "Sexo Masculino",
"Raca Branca"),
column.labels = c("OLS", "FGLS"),
digits = 4)
library(lmtest)
library(stargazer)
#SELECIONAR BASE DE DADOS
load(file.path(input,"regressao_mincer_hetero.RData"))
#CALCULAR VARIÂNCIA
residuos <- residuals(regressao_mincer_hetero)
log_residuos_quadrados <- log(residuos^2)
variancia_modelo <- lm(log_residuos_quadrados ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
data = data)
estimacao_variancia <- exp(predict(variancia_modelo))
#SALVAR COMO .RData
save(estimacao_variancia,
file = file.path(input, "estimacao_variancia.RData"))
#Calculo de Mincer FGLS
regressao_mincer_fgls <- lm(log_wage_hetero ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
weights = 1/estimacao_variancia,
data = data)
#SALVAR COMO .RData
save(regressao_mincer_fgls,
file = file.path(input, "regrssao_mincer_fgls.RData"))
#REPORTANDO COM STARGAZER
stargazer(regressao_mincer, regressao_mincer_fgls,
type = "html",
title = "Mincer OLS X Mincer FGLS",
dep.var.labels = "Log do Salario Heterocedastico",
covariate.labels = c("Anos de Estudo", "Experiencia Profissional",
"Experiencia ao Quadrado", "Regiao Norte",
"Regiao Nordeste", "Regiao Sul",
"Regiao Centro-Oeste", "Sexo Masculino",
"Raca Branca"),
column.labels = c("OLS", "FGLS"),
digits = 4)
library(lmtest)
library(stargazer)
load(file.path("input/BASEAumentada.RData"))
#REGRESSÃO MINCERIANA (HETEROCEDÁSTICA)
regressao_mincer_hetero_ampla <- lm(log_wage_hetero ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
data = data)
#SALVANDO O ARQUIVO
stargazer(regressao_mincer_hetero_ampla,
type = "html",
title = "TABELA REGRESSAO MINCERIANA HETERO Ampla",
dep.var.labels = "Log Salario Hetero",
covariate.labels = c(
"Anos de Estudo",
"Experiencia",
"Experiencia ao Quadrado",
"Regiao Norte",
"Regiao Nordeste",
"Regiao Sul",
"Regiao Centro-Oeste",
"Sexo Masculino",
"Raca Branca"),
digits = 5)
#CALCULAR VARIÂNCIA
residuos <- residuals(regressao_mincer_hetero_ampla)
log_residuos_quadrados_amplos <- log(residuos^2)
variancia_modelo_amplo <- lm(log_residuos_quadrados_amplos ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
data = data)
estimacao_variancia_ampla <- exp(predict(variancia_modelo_amplo))
#Calculo de Mincer FGLS
regressao_mincer_fgls_ampla <- lm(log_wage_hetero ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
weights = 1/estimacao_variancia_ampla,
data = data)
stargazer(regressao_mincer_fgls_ampla,
type = "html",
title = "TABELA REGRESSaO MINCERIANA FGLS Ampla",
dep.var.labels = "Log Salario Hetero",
covariate.labels = c(
"Anos de Estudo",
"Experiencia",
"Experiencia ao Quadrado",
"Regiao Norte",
"Regiao Nordeste",
"Regiao Sul",
"Regiao Centro-Oeste",
"Sexo Masculino",
"Raca Branca"),
digits = 5)
#Salva em .RData
save(regressao_mincer_fgls_ampla,
file = file.path(input, "regrssao_mincer_fgls_ampla.RData"))
#SELECIONAR BASE DE DADOS
load(file.path("input/BASEQ01.RData"))
#REGRESSÃO MINCERIANA (HETEROCEDÁSTICA)
regressao_mincer_hetero <- lm(log_wage_hetero ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
data = data)
residuos <- residuals(regressao_mincer_hetero)
log_residuos_quadrados <- log(residuos^2)
variancia_modelo <- lm(log_residuos_quadrados ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
data = data)
estimacao_variancia <- exp(predict(variancia_modelo))
regressao_mincer_fgls <- lm(log_wage_hetero ~ education +
experience +
I(experience^2) +
north +
northeast +
centerwest +
south +
male +
white,
weights = 1/estimacao_variancia,
data = data)
#SALVAR COMO .RData
save(regressao_mincer_fgls,
file = file.path(input, "regrssao_mincer_fgls.RData"))
#REPORTANDO COM STARGAZER
library(stargazer)
stargazer(regressao_mincer_hetero, regressao_mincer_fgls,
type = "html",
title = "Mincer OLS X Mincer FGLS",
dep.var.labels = "Log do Salario Heterocedastico",
covariate.labels = c("Anos de Estudo", "Experiencia Profissional",
"Experiencia ao Quadrado", "Regiao Norte",
"Regiao Nordeste", "Regiao Sul",
"Regiao Centro-Oeste", "Sexo Masculino",
"Raca Branca"),
column.labels = c("OLS", "FGLS"),
digits = 4,
out = file.path(output, "OLSFGLS.html"))
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("T2dados.xlsx")
# ARQUIVO _MASTER
#CAMINHO DOS DIRETCRIOS
##DIRETCRIO RAIZ (ROOT)
root <- "C:/Users/Kabum/Desktop/TrabalhoEconometria"
#SUBDIRETCRIOS
code <- paste0(root, "/code")
input <- paste0(root, "/input")
misc <- paste0(root, "/misc")
output <- paste0(root, "/output")
tmp <- paste0(root, "/tmp")
###################
#TRABALHO ECONOMETRIA
#PROFESSOR: VITOR PEREIRA
#GRUPO: MARCUS BOTO, PEDRO LATINI
#OBJETIVO DO CÓDIGO - INSTALAR PACOTES
install.packages("dplyr")
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
source("code/_master.R")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("output/T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("input/T2dados.xlsx")
setores <- colnames(dados %>% select(starts_with("setor")))
eq_list <- map(
setores,
~ as.formula(paste0(.x, " ~ cambio + ibcbr"))
)
names(eq_list) <- setores
modelo_sur <- systemfit(eq_list, method = "SUR", data = dados)
summary(modelo_sur)
#O sinal esperado para este coeficiente é positivo, indicando que a desvalorização da moeda local (aumento do cambio) eleva os custos e, consequentemente, os preços dos bens. A maioria dos setores apresentou sinal positivo, então em teoria estão corretos.
#Esses resultados mostram que, embora o repasse cambial seja estatisticamente presente e positivo na maioria dos setores (em linha com a teoria), o modelo como um todo é moderado/fraco na explicação da variação total dos preços.
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("input/T2dados.xlsx")
setores <- colnames(dados %>% select(starts_with("setor")))
eq_list <- map(
setores,
~ as.formula(paste0(.x, " ~ cambio + ibcbr"))
)
names(eq_list) <- setores
modelo_sur <- systemfit(eq_list, method = "SUR", data = dados)
summary(modelo_sur)
teste_lb_setores <- map(
setores,
~ {
modelo <- lm(as.formula(paste0(.x, " ~ cambio + ibcbr")), data = dados)
Box.test(residuals(modelo), lag = 12, type = "Ljung-Box")
}
)
# nomear lista com os setores
names(teste_lb_setores) <- setores
# Exibir resultados
teste_lb_setores
# A conclusão para o teste é mista. Utilizando um nível de significância de alpha = 0.05: Para 10 dos 24 setores (setor00, setor01, setor02, setor04, setor05, setor10, setor11, setor14, setor15 e setor21), o valor-p foi menor que 0.05, o que leva à rejeição da hipótese nula (H0).
# As equações apresentam autocorrelação significativa nos resíduos, indicando que o modelo OLS para esses setores está mal especificado ou precisa de termos autorregressivos.
# Para os outros 14 setores (setor03, setor06, setor07, setor08, setor09, setor12, setor13, setor16, setor17, setor18, setor19, setor20, setor22 e setor23), o valor-p foi superior a 0.05, portanto, a hipótese nula não foi rejeitada. A conclusão para estes setores é que não há evidência estatística de autocorrelação serial nos resíduos.
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
dados <- read_excel("input/T2dados.xlsx")
dados$mes <- factor(format(dados[[1]], "%m"))
setores <- colnames(dados %>% select(starts_with("setor")))
eq_list <- map(
setores,
~ as.formula(paste0(.x, " ~ cambio + ibcbr + mes"))
)
names(eq_list) <- setores
modelo_sur_sazonal <- systemfit(eq_list, method = "SUR", data = dados)
summary(modelo_sur_sazonal)
# Aumentou a magnitude e a coerência teórica dos coeficientes de repasse cambial para a maioria dos setores, reforçando a conclusão de que a sazonalidade estava anteriormente causando distorções nas estimativas.
# O setor17 teve uma mudança drástica e o setor11, o repasse caiu para quase zero.
library(readxl)
library(dplyr)
library(purrr)
library(broom)
dados <- read_excel("T2dados.xlsx")
install.packages("broom")
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
source("code/_master.R")
library(readxl)
library(dplyr)
library(purrr)
library(broom)
dados <- read_excel("input/T2dados.xlsx")
colnames(dados)[1] <- "data"
dados <- dados %>%
mutate(
mes = factor(format(data, "%m"))
)
setores <- colnames(dados %>% select(starts_with("setor")))
rodar_modelo_setor <- function(setor_nome) {
setor_lag1  <- paste0(setor_nome, "_lag1")
dados_modelo <- dados %>%
mutate(
!!setor_lag1 := lag(.data[[setor_nome]], 1),
cambio_lag1  = lag(cambio, 1)
) %>%
filter(!is.na(.data[[setor_lag1]]))
# fórmula dinâmica
form <- as.formula(
paste0(
setor_nome, " ~ cambio + ibcbr + ",
setor_lag1, " + cambio_lag1 + mes"
)
)
modelo <- lm(form, data = dados_modelo)
beta1 <- coef(modelo)["cambio"]
beta4 <- coef(modelo)["cambio_lag1"]
repasse_total <- beta1 + beta4
list(
setor = setor_nome,
modelo = modelo,
repasse_total = repasse_total,
coeficientes = tidy(modelo)
)
}
resultados <- map(setores, rodar_modelo_setor)
tabela_repasse <- map_dfr(resultados, ~ data.frame(
setor = .x$setor,
repasse_total = .x$repasse_total
))
tabela_repasse
# Para 10 dos 24 setores o valor-p foi menor que 0.05, o que leva à rejeição da hipótese nula (H0).
# A conclusão é que as equações para esses 10 setores apresentam autocorrelação serial significativa nos resíduos.
# Para os 14 setores restantes, o valor-p foi maior que 0.05, e a hipótese nula não foi rejeitada. A conclusão é que não há evidência estatística de autocorrelação serial nos resíduos desses modelos.
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
library(lmtest)
dados <- read_excel("T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
library(lmtest)
dados <- read_excel("input/T2dados.xlsx")
colnames(dados)[1] <- "data"
dados <- dados %>%
mutate(
mes = factor(format(data, "%m"))
)
setores <- colnames(dados %>% select(starts_with("setor")))
for (s in setores) {
dados[[paste0(s, "_lag1")]] <- dplyr::lag(dados[[s]], 1)
}
dados$cambio_lag1 <- dplyr::lag(dados$cambio, 1)
dados <- dados %>% filter(!is.na(cambio_lag1))
eq_list <- map(
setores,
~ as.formula(
paste0(
.x, " ~ cambio + ibcbr + ",
.x, "_lag1 + cambio_lag1 + mes"
)
)
)
names(eq_list) <- setores
modelo_sur <- systemfit(eq_list, method = "SUR", data = dados)
summary(modelo_sur)
residuos <- residuals(modelo_sur)
testes <- map(names(residuos), function(s){
res <- residuos[[s]]
lista_testes <- list(
Ljung_Box = Box.test(res, lag = 12, type = "Ljung-Box"),
Breusch_Pagan = bptest(eq_list[[s]], data = dados)
)
return(lista_testes)
})
names(testes) <- names(residuos)
testes
# O impacto total de longo prazo do repasse cambial foi significativamente maior para os preços dos setores setor03 e setor22, indicando que a maior parte da variação cambial é absorvida por esses setores ao longo do tempo. A inclusão da variável dependente defasada e das dummies sazonais melhorou o ajuste do modelo (aumentando o R² ajustado) e aumentou a magnitude do repasse em comparação com o modelo anterior, refletindo melhor a persistência dos choques nos preços.
# Setores como setor09 e setor13 apresentaram um impacto total de longo prazo negativo (mesmo que pequeno), sugerindo que a dinâmica dos preços é dominada por fatores internos e não pelo câmbio.
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
library(lmtest)
dados <- read_excel("T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
library(lmtest)
dados <- read_excel("input/T2dados.xlsx")
colnames(dados)[1] <- "data"
dados <- dados %>%
mutate(
mes = factor(format(data, "%m"))
)
setores <- colnames(dados %>% select(starts_with("setor")))
for (s in setores) {
dados[[paste0(s, "_lag1")]] <- dplyr::lag(dados[[s]], 1)
}
dados$cambio_lag1 <- dplyr::lag(dados$cambio, 1)
dados <- dados %>% filter(!is.na(cambio_lag1))
eq_list <- map(
setores,
~ as.formula(
paste0(
.x, " ~ cambio + ibcbr + ",
.x, "_lag1 + cambio_lag1 + mes"
)
)
)
names(eq_list) <- setores
modelo_sur <- systemfit(eq_list, method = "SUR", data = dados)
residuos <- residuals(modelo_sur)
testes <- map(setores, function(s){
res <- residuos[[s]]
modelo_lm <- lm(eq_list[[s]], data = dados)
lista_testes <- list(
Ljung_Box = Box.test(res, lag = 12, type = "Ljung-Box"),
Breusch_Pagan = bptest(modelo_lm)
)
return(lista_testes)
})
names(testes) <- setores
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
library(lmtest)
library(sandwich)
dados <- read_excel("T2dados.xlsx")
library(readxl)
library(dplyr)
library(purrr)
library(systemfit)
library(lmtest)
library(sandwich)
dados <- read_excel("input/T2dados.xlsx")
colnames(dados)[1] <- "data"
dados <- dados %>%
mutate(
mes  = factor(format(data, "%m"))
)
setores <- colnames(dados %>% select(starts_with("setor")))
dados <- dados %>%
mutate(
cambio_lag1 = lag(cambio, 1)
)
for(s in setores){
dados[[paste0(s, "_lag1")]] <- lag(dados[[s]], 1)
}
dados <- dados %>% filter(!is.na(cambio_lag1))
equacoes <- map(
setores,
~ as.formula(
paste0(.x, " ~ cambio + ibcbr + ",
.x, "_lag1 + cambio_lag1 + mes")
)
)
names(equacoes) <- setores
modelo_sur <- systemfit(equacoes, method = "SUR", data = dados)
summary(modelo_sur)
repasse_total <- map_dbl(
setores,
~ {
coefs <- coef(modelo_sur)[grep(paste0("^", .x, "_"), names(coef(modelo_sur)))]
beta1 <- coefs["cambio"]
beta4 <- coefs["cambio_lag1"]
beta1 + beta4
}
)
repasse_total
residuos_sur <- residuals(modelo_sur)
teste_lb <- map(
setores,
~ Box.test(residuos_sur[[.x]], lag = 12, type = "Ljung-Box")
)
teste_bp <- map(
setores,
~ bptest(equacoes[[.x]], data = dados)
)
modelos_individuais <- map(
setores,
~ lm(
as.formula(paste0(.x, " ~ cambio + ibcbr + ",
.x, "_lag1 + cambio_lag1 + mes")),
data = dados
)
)
coeftest_hac <- map(
modelos_individuais,
~ {
vc <- NeweyWest(.x, lag = 12, prewhite = FALSE)
coeftest(.x, vcov. = vc)
}
)
teste_lb
teste_bp
coeftest_hac
